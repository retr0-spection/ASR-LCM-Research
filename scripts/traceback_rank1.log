Traceback (most recent call last):
  File "/home-mscluster/onailana/ASR-LCM-Research/training5.py", line 111, in <module>
    main()
  File "/home-mscluster/onailana/ASR-LCM-Research/training5.py", line 87, in main
    train(
  File "/home-mscluster/onailana/ASR-LCM-Research/lcm.py", line 332, in train
    scaler.scale(loss_scaled).backward()
  File "/home-mscluster/onailana/miniconda3/envs/env/lib/python3.9/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/home-mscluster/onailana/miniconda3/envs/env/lib/python3.9/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  File "/home-mscluster/onailana/miniconda3/envs/env/lib/python3.9/site-packages/torch/autograd/function.py", line 288, in apply
    return user_fn(self, *args)
  File "/home-mscluster/onailana/miniconda3/envs/env/lib/python3.9/site-packages/torch/utils/checkpoint.py", line 288, in backward
    torch.autograd.backward(outputs_with_grad, args_with_grad)
  File "/home-mscluster/onailana/miniconda3/envs/env/lib/python3.9/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Expected to mark a variable ready only once. This error is caused by one of the following reasons: 1) Use of a module parameter outside the `forward` function. Please make sure model parameters are not shared across multiple concurrent forward-backward passes. or try to use _set_static_graph() as a workaround if this module graph does not change during training loop.2) Reused parameters in multiple reentrant backward passes. For example, if you use multiple `checkpoint` functions to wrap the same part of your model, it would result in the same set of parameters been used by different reentrant backward passes multiple times, and hence marking a variable ready multiple times. DDP does not support such use cases in default. You can try to use _set_static_graph() as a workaround if your module graph does not change over iterations.
Parameter at index 71 with name transformer.layers.5.norm2.weight has been marked as ready twice. This means that multiple autograd engine  hooks have fired for this particular parameter during this iteration.
